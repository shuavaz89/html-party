let PARTY_ELEMENTS=[{element:"select",nodeName:"SELECT"},{element:"textarea",nodeName:"TEXTAREA"},{element:"input",nodeName:"INPUT"},{element:"svg",nodeName:"SVG"},{element:"img",nodeName:"IMG"},{element:"button",nodeName:"BUTTON"},{element:"a",nodeName:"A"},{element:"p",nodeName:"P"},{element:"span",nodeName:"SPAN"},{element:"h1",nodeName:"H1"},{element:"h2",nodeName:"H2"},{element:"h3",nodeName:"H3"},{element:"h4",nodeName:"H4"},{element:"h5",nodeName:"H5"},{element:"h6",nodeName:"H6"},{element:"caption",nodeName:"CAPTION"},{element:"td",nodeName:"TD"}],FUN_COLORS=["#ec1254","#f27c14","#f5e31d","#1ee8b6","#26a1d5","#570bb7","#d042f8","#2edbef","#3aefb6","#f10983","#d61173","#fb5cab","#52c1fa","#178bd5","#f5ed16"],COLOR_FREQ=["#1e8967","#ffd702","#f48d3f","#d02f4e"],PARTY_TEXT_CLASSES=["party-time-color","party-time-textShadow","party-time-colorVolume","party-time-fontSize"],PARTY_CONTAINER_CLASSES=["party-time-boxShadow","party-time-bkgColor","party-time-height","party-time-width","party-time-posTop","party-time-posRight","party-time-posBottom","party-time-posLeft"],PARTY_TIME_CLASSES=["party-time-color","party-time-textShadow","party-time-boxShadow","party-time-bkgColor","party-time-height","party-time-width","party-time-colorVolume","party-time-fontSize","party-time-posTop","party-time-posRight","party-time-posBottom","party-time-posLeft"],PARTY_TIME_FREQ_CLASSES=["","party-time-freq-low","party-time-freq-mid","party-time-freq-high"];function removeArrayItem(t,e){e=t.indexOf(e);-1!==e&&t.splice(e,1)}function cloneArray(t){return JSON.parse(JSON.stringify(t))}function getRandomInt(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}function objToStyles(t,e){for(var o in e)t.style.setProperty(o,e[o],"important")}function middleValue(t,e){return Math.round((t+e)/2)}var partyTimeVidLink="",initVidIframe=!0,setupYTLink=function(t){t=t.target.value;partyTimeVidLink=t},getYTVid=function(){fetch("https://www.youtube.com/watch?v=Eq5a6L7c_UY").then(t=>console.log(t.json())).then(t=>console.log(t))};function generateUI(){var t=document.createElement("div"),e=(t.id="party-time-container",t.classList="party-time-controls",t.style.setProperty("z-index","999999","important"),t.style.setProperty("display","flex","important"),t.style.setProperty("flex-direction","column","important"),t.style.setProperty("color","white","important"),t.style.setProperty("font-size","12px","important"),t.style.setProperty("position","fixed","important"),t.style.setProperty("top","16px","important"),t.style.setProperty("right","16px","important"),t.style.setProperty("background-color","rgba(0,0,0,0.24)","important"),t.style.setProperty("padding","8px","important"),t.style.setProperty("border-radius","8px","important"),document.createElement("div")),o=(e.classList.add("party-time-controls"),document.createElement("button")),o=(o.id="party-time-button",o.classList.add("party-time-controls"),o.innerText="ðŸŽ‰ Party Time!",o.onclick=startParty,objToStyles(o,{"margin-right":"8px",color:"white",cursor:"pointer","background-color":"purple",padding:"8px",border:"1px solid violet","border-radius":"8px","font-size":"12px"}),e.appendChild(o),document.createElement("button")),o=(o.id="party-time-collapse-btn",o.classList.add("party-time-controls"),o.innerText="v",o.onclick=togglePartyTimeOptions,objToStyles(o,{background:"rgba(0, 0, 0, 0.87)",cursor:"pointer",border:"0","border-radius":"24px",padding:"5px 10px","font-weight":"bold","font-size":"18px",transform:"rotate(0deg)",color:"white"}),e.appendChild(o),document.createElement("div")),a=(o.id="party-time-collapsible",o.classList.add("party-time-controls"),o.style.setProperty("display","block","important"),o.style.setProperty("padding","8px","important"),document.createElement("div")),r=(a.classList.add("party-time-controls"),objToStyles(a,{display:"flex",padding:"4px","margin-bottom":"16px"}),document.createElement("button")),r=(r.id="party-time-yt-option-btn",r.classList.add("party-time-controls"),r.innerText="Youtube Link",r.onclick=function(){toggleAudioOption("yt")},objToStyles(r,{padding:"4px",cursor:"pointer",border:"1px solid black","border-top-left-radius":"25px","border-bottom-left-radius":"25px","border-left":"0","background-color":"purple",color:"white"}),a.appendChild(r),document.createElement("button")),r=(r.id="party-time-audio-file-option-btn",r.classList.add("party-time-controls"),r.innerText="Upload File",r.onclick=function(){toggleAudioOption("file")},objToStyles(r,{padding:"4px",cursor:"pointer",border:"1px solid black","border-top-right-radius":"25px","border-bottom-right-radius":"25px","border-right":"0","background-color":"white",color:"black"}),a.appendChild(r),o.appendChild(a),document.createElement("div")),a=(r.id="party-time-ytplayer-container",r.classList.add("party-time-controls"),document.createElement("input")),a=(a.classList.add("party-time-controls"),a.setAttribute("placeholder","Paste youtube link"),a.oninput=setupYTLink,r.appendChild(a),document.createElement("button")),a=(a.classList.add("party-time-controls"),a.innerText="Get Video",a.onclick=getYTVid,r.appendChild(a),document.createElement("div")),a=(a.id="party-time-ytplayer",a.classList.add("party-time-controls"),objToStyles(a,{display:"block"}),r.appendChild(a),o.appendChild(r),document.createElement("input")),r=(a.setAttribute("type","file"),a.id="party-upload",a.classList.add("party-time-controls"),a.onchange=handleAudioFile,objToStyles(a,{width:"150px",display:"none","margin-right":"8px","font-size":"12px","background-color":"black",color:"white"}),o.appendChild(a),document.createElement("label")),a=(r.setAttribute("for","party-auto-party"),r.classList.add("party-time-controls"),r.innerText="Auto Party",objToStyles(r,{"font-weight":"bold",color:"white","font-size":"12px"}),o.appendChild(r),document.createElement("input")),r=(a.setAttribute("type","checkbox"),a.id="party-auto-party",a.classList.add("party-time-controls"),a.onchange=handleAutoParty,o.appendChild(a),document.createElement("label")),a=(r.setAttribute("for","party-debug"),r.classList.add("party-time-controls"),r.innerText="Show Freq",objToStyles(r,{"font-weight":"bold",color:"white","font-size":"12px"}),o.appendChild(r),document.createElement("input"));a.setAttribute("type","checkbox"),a.id="party-debug",a.classList.add("party-time-controls"),a.onchange=handleDebug,o.appendChild(a),t.appendChild(e),t.appendChild(o),document.body.appendChild(t)}function addPartyClasses(t,e){var e=cloneArray(e),o=e[getRandomInt(0,e.length-1)];t.classList.add(o),removeArrayItem(e,o),o=e[getRandomInt(0,e.length-1)],t.classList.add(o)}function setupPartyClasses(t){switch(t.nodeName){case"SELECT":case"TEXTAREA":case"INPUT":addPartyClasses(t,PARTY_TIME_CLASSES);break;case"SVG":case"IMG":addPartyClasses(t,PARTY_CONTAINER_CLASSES);break;case"BUTTON":addPartyClasses(t,PARTY_TIME_CLASSES);break;case"A":case"P":case"SPAN":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"CAPTION":addPartyClasses(t,PARTY_TEXT_CLASSES);break;default:addPartyClasses(t,PARTY_TIME_CLASSES)}}function containsPartyTimeClasses(t){let e=!1;for(var o=0;o<PARTY_TIME_CLASSES.length;o++)t.classList.contains(PARTY_TIME_CLASSES[o])&&(e=!0);return e}function removePartyTimeClasses(t){for(var e=0;e<PARTY_TIME_CLASSES.length;e++)PARTY_TIME_CLASSES[e]&&t.classList.contains(PARTY_TIME_CLASSES[e])&&t.classList.remove(PARTY_TIME_CLASSES[e]);for(var o=0;o<PARTY_TIME_FREQ_CLASSES.length;o++)PARTY_TIME_FREQ_CLASSES[o]&&t.classList.contains(PARTY_TIME_FREQ_CLASSES[o])&&t.classList.remove(PARTY_TIME_FREQ_CLASSES[o])}var _cacheIndex=[],_cacheWidth=[],_cacheHeight=[],_cache=[],_cache2=[],_cache3=[],_cache4=[];let auto_party=!1,debug_mode=!1,is_playing=!1,clear_styles=!1,audioSource=null,analyser=null,animate,audio1;var initSetup=function(){generateUI()},createAudioStream=function(t){console.log("audioSrc",t),audio1=new Audio,"file"===partyTimeAudioOption&&(audio1.src=URL.createObjectURL(t)),console.log("audio1",audio1),console.log("audio1.src",audio1.src),audio1.loop=!0;t=new(window.AudioContext||window.webkitAudioContext);audioSource=t.createMediaElementSource(audio1),analyser=t.createAnalyser(),audioSource.connect(analyser),analyser.connect(t.destination),analyser.fftSize=128},handleAudioFile=function(t){t=t.target.files;createAudioStream(t[0])},partyTimeCollapseState=!1,togglePartyTimeOptions=function(){var t=document.getElementById("party-time-collapsible"),e=document.getElementById("party-time-collapse-btn");partyTimeCollapseState?(partyTimeCollapseState=!1,e.style.setProperty("transform","rotate(180deg)","important"),t.style.setProperty("display","block","important")):(partyTimeCollapseState=!0,e.style.setProperty("transform","rotate(0deg)","important"),t.style.setProperty("display","none","important"))},partyTimeAudioOption="yt",toggleAudioOption=function(t){var e=document.getElementById("party-time-audio-file-option-btn"),o=document.getElementById("party-time-yt-option-btn"),a=document.getElementById("party-upload"),r=document.getElementById("party-time-ytplayer-container");"file"===(partyTimeAudioOption=t)&&(objToStyles(e,{"background-color":"purple",color:"white"}),objToStyles(o,{"background-color":"white",color:"black"}),a.style.setProperty("display","block","important"),r.style.setProperty("display","none","important")),"yt"===t&&(objToStyles(e,{"background-color":"white",color:"black"}),objToStyles(o,{"background-color":"purple",color:"white"}),a.style.setProperty("display","none","important"),r.style.setProperty("display","block","important"))},handleAutoParty=function(t){auto_party=t.target.checked},handleDebug=function(t){debug_mode=t.target.checked},startParty=function(){var o=document.getElementById("party-time-button");if(analyser.fftSize=128,audio1&&audio1.pause(),audio1.src)if(is_playing)audio1.pause(),clearStyles(),is_playing=!1,clear_styles=!0,o.innerText="ðŸŽ‰ Party Time!",cancelAnimationFrame(animate);else{o.innerText="Stop The Party... ðŸ˜”",is_playing=!0,audio1.play();let t=analyser.frequencyBinCount,e=new Uint8Array(t);(animate=function(){clear_styles?clearStyles():(analyser.getByteFrequencyData(e),partyTime(t,e),requestAnimationFrame(animate))})()}},clearStyles=function(){for(var t=document.querySelectorAll('*[class*="party-time"]:not(.party-time-controls)'),e=0,o=t.length;e<o;e++)if(t[e].removeAttribute("style"),t[e].classList.contains("party-time-baby"))for(var a=t[e].querySelectorAll('*[class*="party-time"]:not(.party-time-controls)'),r=0;r<a.length;r++)removePartyTimeClasses(a[r]);for(var n=document.querySelectorAll(".debug-freq"),r=0,o=n.length;r<o;r++)n[r].remove();clear_styles=!1,_cacheIndex=[],_cacheWidth=[],_cacheHeight=[],_cache=[],_cache2=[],_cache3=[],_cache4=[]},applyStyles=function(t){for(var e=0,o=t.length;e<o;e++)t[e].style={}},partyTime=function(e,t){for(var o=[],a=0;a<e;a++)0!==t[a]&&o.push(t[a]);auto_party&&(document.body.classList.contains("party-time-bkgColor")||document.body.classList.add("party-time-bkgColor"),document.body.classList.contains("party-time-baby")||document.body.classList.add("party-time-baby"));var r=document.querySelectorAll('*[class*="party-time"]:not(.party-time-controls)');for(let t=0;t<r.length;t++)if(r[t])if(r[t].classList.contains("party-time-baby")){var n,i=r[t].querySelectorAll("select:not(.debug-freq):not(.party-time-controls),textarea:not(.debug-freq):not(.party-time-controls),input:not(.debug-freq):not(.party-time-controls),svg:not(.debug-freq):not(.party-time-controls),img:not(.debug-freq):not(.party-time-controls),button:not(.debug-freq):not(.party-time-controls),a:not(.debug-freq):not(.party-time-controls),p:not(.debug-freq):not(.party-time-controls),span:not(.debug-freq):not(.party-time-controls),h1:not(.debug-freq):not(.party-time-controls),h2:not(.debug-freq):not(.party-time-controls),h3:not(.debug-freq):not(.party-time-controls),h4:not(.debug-freq):not(.party-time-controls),h5:not(.debug-freq):not(.party-time-controls),h6:not(.debug-freq):not(.party-time-controls),caption:not(.debug-freq):not(.party-time-controls),td:not(.debug-freq):not(.party-time-controls)");for(let t=0;t<i.length;t++)i[t]&&(!containsPartyTimeClasses(i[t])&&(setupPartyClasses(i[t]),n=PARTY_TIME_FREQ_CLASSES[getRandomInt(0,PARTY_TIME_FREQ_CLASSES.length-1)])&&i[t].classList.add(n),vfx(t,i[t],e,o))}else vfx(t,r[t],e,o)},vfx=function(t,e,o,a){_cacheIndex[t]||(_cacheIndex[t]=getRandomInt(0,o-1));let r=a[_cacheIndex[t]]||0!==a[_cacheIndex[t]]?a[_cacheIndex[t]]:a[getRandomInt(0,o-1)];e.classList.contains("party-time-freq-low")&&(r=getFreqRange(a,"low")),e.classList.contains("party-time-freq-mid")&&(r=getFreqRange(a,"mid")),e.classList.contains("party-time-freq-high")&&(r=getFreqRange(a,"high")),e.classList.contains("party-time-color")&&(o=Math.floor(r/100),_cache[t]!==o)&&(_cache[t]=o,e.style.setProperty("color",FUN_COLORS[getRandomInt(0,FUN_COLORS.length-1)],"important")),e.classList.contains("party-time-textShadow")&&(a=Math.floor(r/100),_cache3[t]!==a)&&(_cache3[t]=a,o=FUN_COLORS[getRandomInt(0,FUN_COLORS.length-1)],e.style.setProperty("color","#FFFFFF","important"),e.style.setProperty("text-shadow","0 0 "+r/10+"px #fff, 0 0 "+r/9+"px #fff, 0 0 "+r/8+"px "+o+", 0 0 "+r/7+"px "+o+", 0 0 "+r/6+"px "+o+", 0 0 "+r/5+"px "+o+", 0 0 "+r/4+"px "+o,"important")),e.classList.contains("party-time-boxShadow")&&(a=Math.floor(r/100),_cache4[t]!==a)&&(_cache4[t]=a,o=FUN_COLORS[getRandomInt(0,FUN_COLORS.length-1)],e.style.setProperty("box-shadow","0 0 10px #fff, 0 0 20px #fff, 0 0 30px "+o+", 0 0 40px "+o+", 0 0 50px "+o+", 0 0 60px "+o+", 0 0 70px "+o,"important")),e.classList.contains("party-time-bkgColor")&&(a=Math.floor(r/100),_cache2[t]!==a)&&(_cache2[t]=a,e.style.setProperty("background-color",FUN_COLORS[getRandomInt(0,FUN_COLORS.length-1)],"important")),e.classList.contains("party-time-colorVolume")&&e.style.setProperty("color",COLOR_FREQ[Math.floor(r/100)],"important"),e.classList.contains("party-time-fontSize")&&(o=r/5,e.style.setProperty("font-size",(o<=0?10:o)+"px","important")),e.classList.contains("party-time-width")&&(_cacheWidth[t]||(_cacheWidth[t]=e.offsetWidth),e.style.setProperty("width",_cacheWidth[t]+r/2+"px","important")),e.classList.contains("party-time-height")&&(_cacheHeight[t]||(_cacheHeight[t]=e.offsetHeight),e.style.setProperty("height",_cacheHeight[t]+r/2+"px","important")),e.classList.contains("party-time-posTop")&&(e.style.setProperty("position","relative","important"),e.style.setProperty("top",r/5+"px","important")),e.classList.contains("party-time-posRight")&&(e.style.setProperty("position","relative","important"),e.style.setProperty("right",r/5+"px","important")),e.classList.contains("party-time-posBottom")&&(e.style.setProperty("position","relative","important"),e.style.setProperty("bottom",r/5+"px","important")),e.classList.contains("party-time-posLeft")&&(e.style.setProperty("position","relative","important"),e.style.setProperty("left",r/5+"px","important")),debug_mode?(a=e.querySelector(".debug-freq"))?a.innerText="Freq: "+r+"Hz":((o=document.createElement("span")).classList.add("debug-freq"),o.style.display="inline-block",o.style["font-size"]="12px",o.style.padding="4px",o.style["background-color"]="rgba(0,0,0,0.48)",o.style.color="#FFFFFF",o.style["border-radius"]="8px",o.innerText="Freq: "+r+"Hz",e.appendChild(o)):(t=e.querySelector(".debug-freq"))&&t.remove()},getFreqRange=function(t,e){switch(e){case"low":return t[t.length-1];case"mid":return t[middleValue(0,t.length-1)];case"high":return t[0]}};initSetup();