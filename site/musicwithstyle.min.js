let FUN_COLORS=["#ec1254","#f27c14","#f5e31d","#1ee8b6","#26a1d5","#570bb7","#d042f8","#2edbef","#3aefb6","#f10983","#d61173","#fb5cab","#52c1fa","#178bd5","#f5ed16"],COLOR_FREQ=["#1e8967","#ffd702","#f48d3f","#d02f4e"],PARTY_TIME_CLASSES=["party-time-color","party-time-textShadow","party-time-boxShadow","party-time-bkgColor","party-time-height","party-time-width","party-time-colorVolume","party-time-fontSize","party-time-posTop","party-time-posRight","party-time-posBottom","party-time-posLeft"],PARTY_TIME_FREQ_CLASSES=["","party-time-freq-low","party-time-freq-mid","party-time-freq-high"];function containsPartyTimeClasses(t){let e=!1;for(var a=0;a<PARTY_TIME_CLASSES.length;a++)t.classList.contains(PARTY_TIME_CLASSES[a])&&(e=!0);return e}function removePartyTimeClasses(t){for(var e=0;e<PARTY_TIME_CLASSES.length;e++)PARTY_TIME_CLASSES[e]&&t.classList.contains(PARTY_TIME_CLASSES[e])&&t.classList.remove(PARTY_TIME_CLASSES[e]);for(var a=0;a<PARTY_TIME_FREQ_CLASSES.length;a++)PARTY_TIME_FREQ_CLASSES[a]&&t.classList.contains(PARTY_TIME_FREQ_CLASSES[a])&&t.classList.remove(PARTY_TIME_FREQ_CLASSES[a])}function objToStyles(t){var e,a="";for(e in t)a+=e+":"+t[e]+"!important;";return a}function getRandomInt(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}function middleValue(t,e){return Math.round((t+e)/2)}var _cacheIndex=[],_cacheWidth=[],_cacheHeight=[],_cache=[],_cache2=[],_cache3=[],_cache4=[];let auto_party=!1,debug_mode=!1,is_playing=!1,clear_styles=!1,audioSource=null,analyser=null,animate,audio1;var initSetup=function(){var t=document.createElement("div");t.id="party-time-container",t.classList="party-time-controls",t.style.setProperty("z-index","999999","important"),t.style.setProperty("color","white","important"),t.style.setProperty("font-size","12px","important"),t.style.setProperty("position","fixed","important"),t.style.setProperty("top","16px","important"),t.style.setProperty("right","16px","important"),t.style.setProperty("background-color","rgba(0,0,0,0.24)","important"),t.style.setProperty("padding","8px","important"),t.style.setProperty("border-radius","8px","important"),t.innerHTML='<button id="party-time-button" class="party-time-controls" style="'+objToStyles({"margin-right":"8px",color:"white",cursor:"pointer","background-color":"purple",padding:"8px",border:"1px solid violet","border-radius":"8px","font-size":"12px"})+'">ðŸŽ‰ Party Time!</button>',t.innerHTML+='<input type="file" id="party-upload" class="party-time-controls" style="'+objToStyles({"margin-right":"8px","font-size":"12px"})+'" />',t.innerHTML+='<label for="party-auto-party" class="party-time-controls" style="'+objToStyles({"font-weight":"bold",color:"white","font-size":"12px"})+'">Auto Party</label>',t.innerHTML+='<input type="checkbox" id="party-auto-party" class="party-time-controls" />',t.innerHTML+='<label for="party-debug" class="party-time-controls" style="'+objToStyles({"font-weight":"bold",color:"white","font-size":"12px"})+'">Show Freq</label>',t.innerHTML+='<input type="checkbox" id="party-debug" class="party-time-controls" />',t.innerHTML+='<div id="player"></div>',document.body.appendChild(t),document.getElementById("party-time-button").onclick=startParty,document.getElementById("party-upload").onchange=handleAudioFile,document.getElementById("party-auto-party").onchange=handleAutoParty,document.getElementById("party-debug").onchange=handleDebug},handleAudioFile=function(t){t=t.target.files,(audio1=new Audio).src=URL.createObjectURL(t[0]),audio1.loop=!0,t=new(window.AudioContext||window.webkitAudioContext);audioSource=t.createMediaElementSource(audio1),analyser=t.createAnalyser(),audioSource.connect(analyser),analyser.connect(t.destination),analyser.fftSize=128},handleAutoParty=function(t){auto_party=t.target.checked},handleDebug=function(t){debug_mode=t.target.checked},startParty=function(){var a=document.getElementById("party-time-button");if(analyser.fftSize=128,console.log(audio1.src),audio1&&audio1.pause(),audio1.src)if(is_playing)audio1.pause(),clearStyles(),is_playing=!1,clear_styles=!0,a.innerText="ðŸŽ‰ Party Time!",cancelAnimationFrame(animate);else{a.innerText="Stop The Party... ðŸ˜”",is_playing=!0,audio1.play();let t=analyser.frequencyBinCount,e=new Uint8Array(t);(animate=function(){clear_styles?clearStyles():(analyser.getByteFrequencyData(e),partyTime(t,e),requestAnimationFrame(animate))})()}},clearStyles=function(){for(var t=document.querySelectorAll('*[class*="party-time"]:not(.party-time-controls)'),e=0,a=t.length;e<a;e++)if(t[e].removeAttribute("style"),t[e].classList.contains("party-time-baby"))for(var o=t[e].querySelectorAll('*[class*="party-time"]:not(.party-time-controls)'),r=0;r<o.length;r++)removePartyTimeClasses(o[r]);for(var n=document.querySelectorAll(".debug-freq"),r=0,a=n.length;r<a;r++)n[r].remove();clear_styles=!1,_cacheIndex=[],_cacheWidth=[],_cacheHeight=[],_cache=[],_cache2=[],_cache3=[],_cache4=[]},applyStyles=function(t){for(var e=0,a=t.length;e<a;e++)t[e].style={}},partyTime=function(e,t){for(var a=[],o=0;o<e;o++)0!==t[o]&&a.push(t[o]);auto_party&&(document.body.classList.contains("party-time-bkgColor")||document.body.classList.add("party-time-bkgColor"),document.body.classList.contains("party-time-baby")||document.body.classList.add("party-time-baby"));var r=document.querySelectorAll('*[class*="party-time"]:not(.party-time-controls)');for(let t=0;t<r.length;t++)if(r[t])if(r[t].classList.contains("party-time-baby")){var n,i=r[t].querySelectorAll("svg:not(.debug-freq),img:not(.debug-freq),button:not(.debug-freq),a:not(.debug-freq),p:not(.debug-freq),span:not(.debug-freq),h1:not(.debug-freq),h2:not(.debug-freq),h3:not(.debug-freq),h4:not(.debug-freq),h5:not(.debug-freq),h6:not(.debug-freq),caption:not(.debug-freq),td:not(.debug-freq)");for(let t=0;t<i.length;t++)i[t]&&(!containsPartyTimeClasses(i[t])&&(i[t].classList.add(PARTY_TIME_CLASSES[getRandomInt(0,PARTY_TIME_CLASSES.length-1)]),n=PARTY_TIME_FREQ_CLASSES[getRandomInt(0,PARTY_TIME_FREQ_CLASSES.length-1)])&&i[t].classList.add(n),vfx(t,i[t],e,a))}else vfx(t,r[t],e,a)},vfx=function(t,e,a,o){_cacheIndex[t]||(_cacheIndex[t]=getRandomInt(0,a-1)),o[_cacheIndex[t]];let r=o[_cacheIndex[t]];e.classList.contains("party-time-freq-low")&&(r=getFreqRange(o,"low")),e.classList.contains("party-time-freq-mid")&&(r=getFreqRange(o,"mid")),e.classList.contains("party-time-freq-high")&&(r=getFreqRange(o,"high")),e.classList.contains("party-time-color")&&(a=Math.floor(r/100),_cache[t]!==a)&&(_cache[t]=a,e.style.setProperty("color",FUN_COLORS[getRandomInt(0,FUN_COLORS.length-1)],"important")),e.classList.contains("party-time-textShadow")&&(o=Math.floor(r/100),_cache3[t]!==o)&&(_cache3[t]=o,a=FUN_COLORS[getRandomInt(0,FUN_COLORS.length-1)],e.style.setProperty("color","#FFFFFF","important"),e.style.setProperty("text-shadow","0 0 "+r/10+"px #fff, 0 0 "+r/9+"px #fff, 0 0 "+r/8+"px "+a+", 0 0 "+r/7+"px "+a+", 0 0 "+r/6+"px "+a+", 0 0 "+r/5+"px "+a+", 0 0 "+r/4+"px "+a,"important")),e.classList.contains("party-time-boxShadow")&&(o=Math.floor(r/100),_cache4[t]!==o)&&(_cache4[t]=o,a=FUN_COLORS[getRandomInt(0,FUN_COLORS.length-1)],e.style.setProperty("box-shadow","0 0 10px #fff, 0 0 20px #fff, 0 0 30px "+a+", 0 0 40px "+a+", 0 0 50px "+a+", 0 0 60px "+a+", 0 0 70px "+a,"important")),e.classList.contains("party-time-bkgColor")&&(o=Math.floor(r/100),_cache2[t]!==o)&&(_cache2[t]=o,e.style.setProperty("background-color",FUN_COLORS[getRandomInt(0,FUN_COLORS.length-1)],"important")),e.classList.contains("party-time-colorVolume")&&e.style.setProperty("color",COLOR_FREQ[Math.floor(r/100)],"important"),e.classList.contains("party-time-fontSize")&&(a=r/5,e.style.setProperty("font-size",(a<=0?10:a)+"px","important")),e.classList.contains("party-time-width")&&(_cacheWidth[t]||(_cacheWidth[t]=e.offsetWidth),e.style.setProperty("width",_cacheWidth[t]+r/2+"px","important")),e.classList.contains("party-time-height")&&(_cacheHeight[t]||(_cacheHeight[t]=e.offsetHeight),e.style.setProperty("height",_cacheHeight[t]+r/2+"px","important")),e.classList.contains("party-time-posTop")&&(e.style.setProperty("position","relative","important"),e.style.setProperty("top",r/5+"px","important")),e.classList.contains("party-time-posRight")&&(e.style.setProperty("position","relative","important"),e.style.setProperty("right",r/5+"px","important")),e.classList.contains("party-time-posBottom")&&(e.style.setProperty("position","relative","important"),e.style.setProperty("bottom",r/5+"px","important")),e.classList.contains("party-time-posLeft")&&(e.style.setProperty("position","relative","important"),e.style.setProperty("left",r/5+"px","important")),debug_mode?(o=e.querySelector(".debug-freq"))?o.innerText="Freq: "+r+"Hz":((a=document.createElement("span")).classList.add("debug-freq"),a.style.display="inline-block",a.style["font-size"]="12px",a.style.padding="4px",a.style["background-color"]="rgba(0,0,0,0.48)",a.style.color="#FFFFFF",a.style["border-radius"]="8px",a.innerText="Freq: "+r+"Hz",e.appendChild(a)):(t=e.querySelector(".debug-freq"))&&t.remove()},getFreqRange=function(t,e){switch(e){case"low":return t[t.length-1];case"mid":return t[middleValue(0,t.length-1)];case"high":return t[0]}};initSetup();